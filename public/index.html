<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/index.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <title>Epi Solutions</title>
  </head>
  <body>
    <section id="hero" style="--bg-url: url('../img/background.png')">
      <nav>
        <h1 id="logo">
          EPI <br />
          Solutions
        </h1>
        <ul id="navbar">
          <li><a href="./index.html">Início</a></li>
          <li><a href="./pages/products.html">Produtos</a></li>
          <li id="login-item">
            <a href="./pages/login.html" id="login-link">Login</a>
            <span id="user-welcome" style="display: none;"></span>
            <button id="logout-btn" style="display: none; cursor: pointer; background: none; border: none; padding: 0;">
              <img src="./img/icons8-x-24.png" alt="Sair">
            </button>
          </li>
        </ul>
      </nav>

      <div id="main">
        <h1 id="textmain">
          Os melhores equipamentos <br />
          de EPI, você encontra aqui!
        </h1>
        <hr id="mainhr" />
      </div>
    </section>

    <div id="beneficios">
      <h1>Benefícios</h1>
      <section id="cards">
        <div class="cardb">
          <h3 class="titlecard">Atendimento Empresarial Especializado</h3>
          <p class="cardtext">
            Oferecemos consultoria técnica para auxiliar sua empresa na escolha
            dos EPIs ideais conforme o grau de risco e exigências das Normas
            Regulamentadoras (NRs).
          </p>
        </div>
        <div class="cardb">
          <h3 class="titlecard">
            Logística Ágil e <br />
            Atendimento Nacional
          </h3>
          <p class="cardtext">
            Entregas rápidas, com processos otimizados para empresas que não
            podem parar. Atendemos todo o Brasil com compromisso e pontualidade.
          </p>
        </div>
        <div class="cardb">
          <h3 class="titlecard">
            Qualidade Certificada e <br />
            Catálogo Completo
          </h3>
          <p class="cardtext">
            EPIs com CA válido, das melhores marcas do mercado. Soluções
            duráveis, seguras e com ótimo custo-benefício para o seu negócio.
          </p>
        </div>
      </section>
    </div>

    <div id="produtos">
      <h1>Confira nossos principais produtos</h1>
      <div id="cards">
        <div class="products">
          <div class="container">
            <img src="./img/capacete.png" alt="Capacete" />
          </div>
        </div>
        <div class="products">
          <div class="container">
            <img src="./img/sapato.png" alt="Sapato" />
          </div>
        </div>
        <div class="products">
          <div class="container">
            <img src="./img/luva.png" alt="Luva" />
          </div>
        </div>
        <div class="products">
          <div class="container">
            <img src="./img/abafador.png" alt="Abafador" />
          </div>
        </div>
      </div>

      <div id="button">
        <a href="./pages/products.html">
          <button class="animated-button">
            <svg xmlns="http://www.w3.org/2000/svg" class="arr-2" viewBox="0 0 24 24">
              <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
            </svg>
            <span class="text">Ver mais</span>
            <span class="circle"></span>
            <svg xmlns="http://www.w3.org/2000/svg" class="arr-1" viewBox="0 0 24 24">
              <path d="M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"></path>
            </svg>
          </button>
        </a>
      </div>
    </div>

    <footer>
      <h1 id="logo">
        EPI <br />
        Solutions
      </h1>
      <p>© 2024 Epi Solutions. Todos os direitos reservados.</p>
    </footer>
    <script>
      // Pega só o primeiro nome
      function getFirstName(fullName) {
        if (!fullName) return '';
        return fullName.trim().split(/\s+/)[0];
      }

      // Atualiza a navbar
      function updateNavbar() {
        const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
        const userData = localStorage.getItem('user');

        const loginLink = document.getElementById('login-link');
        const userWelcome = document.getElementById('user-welcome');
        const logoutBtn = document.getElementById('logout-btn');
        const loginItem = document.getElementById('login-item');

        if (isLoggedIn && userData) {
          const user = JSON.parse(userData);
          const firstName = getFirstName(user.nome || user.name || '');

          // Esconde login e mostra boas-vindas
          if (loginLink) loginLink.style.display = 'none';
          if (userWelcome) {
            userWelcome.textContent = `Olá, ${firstName}`;
            userWelcome.style.display = 'inline';
            userWelcome.style.color = 'rgba(255, 255, 255, 0.747)';
            userWelcome.style.marginRight = '10px';
            userWelcome.style.fontFamily = "'Poppins', sans-serif";
            userWelcome.style.fontSize = '32px';
            userWelcome.style.fontWeight = '700';
          }
          if (logoutBtn) logoutBtn.style.display = 'inline';
          if (loginItem) {
            loginItem.style.display = 'flex';
            loginItem.style.alignItems = 'center';
            loginItem.style.gap = '10px';
          }
        } else {
          if (loginLink) loginLink.style.display = 'inline';
          if (userWelcome) userWelcome.style.display = 'none';
          if (logoutBtn) logoutBtn.style.display = 'none';
          if (loginItem) {
            loginItem.style.display = '';
            loginItem.style.alignItems = '';
            loginItem.style.gap = '';
          }
        }
      }

      // Logout
      document.getElementById('logout-btn')?.addEventListener('click', () => {
        if (confirm('Deseja realmente sair?')) {
          localStorage.removeItem('isLoggedIn');
          localStorage.removeItem('user');
          alert('Logout realizado com sucesso!');
          updateNavbar();
          location.reload();
        }
      });

      // Executa ao carregar a página
      document.addEventListener('DOMContentLoaded', () => {
        updateNavbar();
      });

      // Atualiza se o login for feito em outra aba
      window.addEventListener('storage', (e) => {
        if (e.key === 'isLoggedIn' || e.key === 'user') {
          updateNavbar();
        }
      });
    </script>
  </body>
</html>