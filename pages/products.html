<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../css/products.css" />
    <link rel="stylesheet" href="../css/style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
    <title>Epi Solutions</title>
  </head>
  <body>
    <nav>
      <h1 id="logo">
        EPI <br />
        Solutions
      </h1>

      <ul id="navbar">
        <li><a href="../index.html">Início</a></li>
        <li><a href="products.html">Produtos</a></li>
        <li id="login-item">
          <a href="./login.html" id="login-link">Login</a>
          <span id="user-welcome" style="display: none;"></span>
          <button id="logout-btn" style="cursor: pointer;"><img src="../img/icons8-x-24.png" alt=""></button>
        </li>
      </ul>
    </nav>
    <main>
      <h1>EPI's</h1>
      <section id="cardsdiv">
        <div class="card">
          <img
            class="cardimg"
            src="../img/products/image 3.png"
            alt="Luvas de proteção"
          />
          <h2>Luvas de proteção</h2>
          <p>Luvas emborrachadas</p>
          <span><strong>R$10,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
        <div class="card">
          <img
            class="cardimg"
            src="../img/products/1051609_oculos-rio-de-janeiro-poli-fer-incolor-com-ajuste-ca-34082_z7_637359625064021680-removebg-preview 1.png"
            alt="Oculos de proteção"
          />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
        <div class="card">
          <img
            class="cardimg"
            src="../img/products/capacete_msa_v_gard_com_jugular_c_a_498_cores_variadas_1571_1_a6203fb502562b465c3d3190cc391863-removebg-preview 2.png"
            alt="Capacete"
          />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
        <div class="card">
          <img
            class="cardimg"
            src="../img/products/D_NQ_NP_2X_998845-MLB96488044463_102025-F-luva-anti-corte-proteco-maxima-resistncia-epi-profissional-removebg-preview 2.png"
            alt="Luvas anti corte"
          />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
      </section>

      <section id="cardsdiv">
        <div class="card">
          <img
            class="cardimg"
            src="../img/products/SAPATO_SV62_CONFORTO_20220805-removebg-preview 2.png"
            alt="Sapato"
          />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
        <div class="card">
          <img
            class="cardimg"
            src="../img/products/1051947_mascara-respiratoria-pff2-com-valvula-pro-agro-delta-plus-ca-38503_z6_638252692832063519-removebg-preview 1.png"
            alt="Máscara respiratória"
          />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
        <div class="card">
          <img class="cardimg" src="../img/products/fone_de_ouvido-removebg-preview 1.png" alt="Abafadores" />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
        <div class="card">
          <img class="cardimg" src="../img/products/bota_galocha-removebg-preview 1.png" alt="Botas" />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
      </section>

      <section id="cardsdiv">
        <div class="card">
          <img class="cardimg" src="../img/products/soldador-removebg-preview (1) 1.png" alt="mascara soldador" />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
        <div class="card">
          <img class="cardimg" src="../img/products/colete_1-removebg-preview 1.png" alt="Colete" />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
        <div class="card">
          <img class="cardimg" src="../img/products/cinto-removebg-preview 1.png" alt="Cinto " />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
        <div class="card">
          <img class="cardimg" src="../img/products/Rectangle.png" alt="Óculos de proteção" />
          <h2>Nome do Produto</h2>
          <p>Descrição do produto</p>
          <span><strong>R$00,00</strong></span>
          <button class="alugarbtn">Quero Alugar!</button>
        </div>
      </section>
    </main>
    <script>
      // Função para extrair apenas o primeiro nome
      function getFirstName(fullName) {
        if (!fullName) return '';
        
        // Remove espaços extras e divide o nome
        const names = fullName.trim().split(/\s+/);
        
        // Retorna o primeiro nome (primeira palavra)
        return names[0];
      }

      // Verificar se o usuário está logado e atualizar a navbar
      function updateNavbar() {
        const isLoggedIn = localStorage.getItem('isLoggedIn');
        const userData = localStorage.getItem('user');
        const loginLink = document.getElementById('login-link');
        const userWelcome = document.getElementById('user-welcome');
        const logoutBtn = document.getElementById('logout-btn');
        const loginItem = document.getElementById('login-item');

        if (isLoggedIn === 'true' && userData) {
          const user = JSON.parse(userData);
          console.log('Usuário logado:', user);
          
          // Extrair apenas o primeiro nome
          const firstName = getFirstName(user.nome);
          console.log('Primeiro nome:', firstName);
          
          // Esconder link de login
          if (loginLink) loginLink.style.display = 'none';
          
          // Mostrar boas-vindas com apenas o primeiro nome
          if (userWelcome) {
            userWelcome.textContent = `Olá, ${firstName}`;
            userWelcome.style.display = 'inline';
            userWelcome.style.color = 'rgba(255, 255, 255, 0.747)';
            userWelcome.style.marginRight = '10px';
            userWelcome.style.fontFamily = "'Poppins', sans-serif";
            userWelcome.style.fontSize = "32px"
            userWelcome.style.fontWeight = '700';
          }
          
          // Mostrar botão de logout
          if (logoutBtn) {
            logoutBtn.style.display = 'inline';
          }

          // Ajustar o estilo do item de login
          if (loginItem) {
            loginItem.style.display = 'flex';
            loginItem.style.alignItems = 'center';
            loginItem.style.gap = '10px';
          }
        } else {
          console.log('Usuário não está logado');
          // Garantir que o login está visível
          if (loginLink) loginLink.style.display = 'inline';
          if (userWelcome) userWelcome.style.display = 'none';
          if (logoutBtn) logoutBtn.style.display = 'none';
          
          // Resetar estilo do item de login
          if (loginItem) {
            loginItem.style.display = '';
            loginItem.style.alignItems = '';
            loginItem.style.gap = '';
          }
        }
      }

      // Função de logout
      function setupLogout() {
        const logoutBtn = document.getElementById('logout-btn');
        if (logoutBtn) {
          logoutBtn.addEventListener('click', function() {
            if (confirm('Deseja realmente sair?')) {
              localStorage.removeItem('user');
              localStorage.removeItem('isLoggedIn');
              alert('Logout realizado com sucesso!');
              updateNavbar();
              window.location.href = '/';
            }
          });
        }
      }

      // Quando a página carregar
      document.addEventListener('DOMContentLoaded', function() {
        updateNavbar();
        setupLogout();
        console.log('Página inicial carregada');
        console.log('Status login:', localStorage.getItem('isLoggedIn'));
        console.log('Usuário:', localStorage.getItem('user'));
      });

      // Atualizar também quando houver mudanças no storage (caso faça login em outra aba)
      window.addEventListener('storage', function(e) {
        if (e.key === 'isLoggedIn' || e.key === 'user') {
          updateNavbar();
        }
      });
    </script>
  </body>
</html>
